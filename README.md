# FrameModelMaker-Web

立体フレーム（骨組構造）の解析モデルを作成・編集・可視化するための Web アプリケーションです。
ブラウザ上で動作し、インストール不要で構造解析用のモデルデータを扱えます。

> C# Windows Forms アプリケーション「Ebi-FrameTerminal」の Web 版として再実装しました。

## 主な機能

- **3D モデルビューア** — Three.js による立体フレームモデルのリアルタイム 3D 表示。回転・パン・ズームに対応
- **データ編集** — 節点・部材・断面・材料・境界条件・バネ・壁・荷重をタブ切替式のグリッドで直接編集
- **ファイル入出力** — StructForm フォーマット（`.dat`）の読み込みと書き出し。Shift_JIS / UTF-8 に対応
- **モデル操作** — 節点ソート、番号再割当、重複ノード統合
- **荷重定義管理** — 複数の荷重ケースの追加・削除・切替

## 技術スタック

| 項目 | 技術 |
|------|------|
| 言語 | TypeScript |
| 3D 描画 | [Three.js](https://threejs.org/) v0.182 |
| ビルド | [Vite](https://vite.dev/) v7.3 |
| デプロイ | GitHub Pages（静的ホスティング） |

## セットアップ

```bash
# 依存関係のインストール
npm install

# 開発サーバーの起動
npm run dev

# プロダクションビルド（dist/ に出力）
npm run build

# ビルド結果のプレビュー
npm run preview
```

## 使い方

### ファイル操作

| 操作 | 説明 |
|------|------|
| 新規作成 | 空のモデルを作成 |
| 開く | `.dat` ファイルを読み込み |
| 保存 | 現在のモデルを `.dat` ファイルとしてダウンロード |
| サンプル読込 | 内蔵のサンプルデータ（3 階建て建物モデル）を読み込み |

### 3D ビュー操作

| マウス操作 | 動作 |
|------------|------|
| 左ドラッグ | 回転 |
| 右ドラッグ | 平行移動 |
| ホイール | ズーム |

### データ編集

画面右側のデータパネルで、タブを切り替えてモデルの各要素を編集できます。

**編集可能なデータ**: 節点、境界条件、材料、断面、バネ、部材、壁、節点荷重、CMQ 荷重、部材荷重

## 単位系・座標系

| 種別 | 単位 |
|------|------|
| 長さ | cm |
| 力 | kN |
| モーメント | kN\*cm |
| 応力 | kN/cm² |

座標系は **X**（水平・右方向）、**Y**（水平・奥行方向）、**Z**（鉛直・上方向）です。

## プロジェクト構成

```
src/
├── main.ts              # アプリケーションのエントリポイント
├── models/              # データモデル（Node, Member, Section 等）
│   └── FrameDocument.ts # ドキュメント統括クラス
├── io/                  # ファイル入出力
│   ├── StructFormParser.ts  # .dat 読み込み
│   └── StructFormWriter.ts  # .dat 書き出し
├── viewer/
│   └── ModelViewer.ts   # Three.js 3D ビューア
├── ui/
│   └── DataGrid.ts      # 汎用データグリッドコンポーネント
└── styles/
    └── main.css
```

## StructForm ファイルフォーマット

StructForm フォーマット（`.dat`）は、フレーム構造解析で使用されるテキスト形式のデータファイルです。
エンコーディングは Shift_JIS、区切り文字はカンマ（`,`）を使用します。

<details>
<summary>ファイル構造の概要</summary>

```
START                          # ファイル開始
TITLE                          # タイトルセクション
CONTROL / M-CONTROL            # 制御パラメータ
NODE                           # 節点データ（番号, X, Y, Z, ...）
BOUNDARY                       # 境界条件（拘束情報）
MATERIAL                       # 材料データ（ヤング係数, せん断弾性係数 等）
SECTION                        # 断面データ（断面積, 断面二次モーメント 等）
MEM1-SPRING                    # バネデータ（省略可）
MEMBER                         # 部材データ（I端・J端節点, 断面番号 等）
WALL                           # 壁エレメント（省略可）
AI-LOAD                        # 荷重制御
LOAD-DEFINITION                # 荷重定義（複数ケース、繰り返し）
  F-NODE                       #   節点荷重
  F-CMQ                        #   CMQ 荷重
  F-MEMBER                     #   部材荷重
CALCULATION-CASE               # 荷重組合せ情報（省略可）
STOP                           # ファイル終了
```

各セクションはキーワード行で区切られます。省略可能なセクション（`MEM1-SPRING`、`WALL`）が存在しない場合は、次のセクションに直接移行します。

</details>

詳細な仕様は [`docs/SPECIFICATION.md`](docs/SPECIFICATION.md) を参照してください。

## 開発

### 前提条件

- Node.js 18 以上
- npm

### ビルドと検証

```bash
# TypeScript の型チェック
npx tsc --noEmit

# 開発サーバー（ホットリロード対応）
npm run dev
```

## ライセンス

このプロジェクトのライセンスについては、リポジトリのライセンスファイルを参照してください。
